[tool.poetry]
name = "qats"
version = "0.0.0"   # overridden by dynamic versioning, must still be specified
description = "Library for efficient processing and visualization of time series"
authors = [
    "Per Voie <per.voie@gmail.com>", 
    "Erling Lone <erling.lone@gmail.com>"
    ]
license = "MIT"
readme = "README.md"
include = [
    "LICENSE",
    "CHANGELOG.md",
    "*/_version.py"
]
# some urls given here instead of ulrs section (affects listed order on PyPi)
homepage = "https://github.com/dnvgl/qats"
repository = "https://github.com/dnvgl/qats"
documentation = "https://qats.readthedocs.io"

[tool.poetry.urls]
# additional urls not listed under tool.poetry
Download = "https://pypi.org/project/qats/"
Issues = "https://github.com/dnvgl/qats/issues"
Changelog = "https://github.com/dnvgl/qats/releases"

[[tool.poetry.source]]
# fix issue that causes `poetry install` to fail for python 3.12, see:
# https://github.com/python-poetry/poetry/issues/9293#issuecomment-2048205226
name = "pypi-public"
url = "https://pypi.org/simple/"

[tool.poetry.dependencies]
python = ">=3.8.1,<3.13"
h5py = ">=3.5.0"
pymatreader = ">=0.0.24"
matplotlib = ">=3.3.3"
nptdms = ">=1.1.0"
numpy = [
    {version = ">=1.21.6", python = "<3.12"},
    {version = ">=1.26.0", python = ">=3.12"}
]
openpyxl = ">=3.0.5"
pandas = [
    # force pandas >=2.2.0 for python 3.12
    # (official support for python 3.12 is introduced in pandas 2.2.0, but poetry tries to install pandas 2.0.3)
    {version = ">=1.1.4", python = "<3.12"},
    {version = ">=2.2.0", python = ">=3.12"}
]
qtpy = ">=1.9.0"
scipy = [
    {version = ">=1.9.0", python = "<3.12"},
    {version = ">=1.11.1", python = ">=3.12"}
]
pywin32 = {version = "^306", markers = "platform_system == 'Windows'"} # MUST check the appropriate constraint
pyside6 = "^6.6.0"

[tool.poetry.group.dev.dependencies]
pytest = "^7.4.3"
flake8 = "^6.1.0"
black = "^23.11.0"
isort = "^5.12.0"

[tool.poetry.group.docs.dependencies]
sphinx = ">=7.1.2"
furo = ">=2023.9.10"
myst-parser = ">=2.0.0"

[tool.poetry.scripts]
qats = "qats.cli:main"

# enable dynamic versioning using Git tags
# https://pypi.org/project/poetry-dynamic-versioning/
[tool.poetry-dynamic-versioning]
enable = true
vcs = "git"
format-jinja = """
    {%- if distance == 0 -%}
        {{ serialize_pep440(base, stage, revision) }}
    {%- elif revision is not none -%}
        {{ serialize_pep440(base, stage, revision + 1, dev=distance, metadata=[commit]) }}
    {%- else -%}
        {{ serialize_pep440(bump_version(base), stage, revision, dev=distance, metadata=[commit]) }}
    {%- endif -%}
"""

[tool.poetry-dynamic-versioning.files."qats/_version.py"]
persistent-substitution = true
initial-content = """
# file generated by poetry dynamic versioning during poetry build/install
# don't change, don't track in version control
__version__ = "0.0.0"
__version_tuple__ = (0, 0, 0)
"""
[build-system]
# https://pypi.org/project/poetry-dynamic-versioning/
requires = ["poetry-core>=1.0.0", "poetry-dynamic-versioning>=1.1.1,<2.0.0"]
build-backend = "poetry_dynamic_versioning.backend"  # "poetry.core.masonry.api"
